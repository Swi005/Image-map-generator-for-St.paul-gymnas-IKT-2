<!DOCTYPE html>
<html>
<head>  
</head>
<body>
    <div id="upload">
        <h1>Upload your File!</h1>
        <input id="file" type="file">
        <button id="next0">Next Step</button>
    </div>
    
    <canvas id="canvas"></canvas>
    
    <div>
        <h2>Create Points</h2>
        <button id="newBox" onclick="draw()">Add new box</button>
    </div>
</body>
<script src="oxygenFuncs.js"></script>

<script>
    var canvas = document.getElementById("canvas");
    var ctx = canvas.getContext("2d");
    canvas.width = 400;
    canvas.height = 300;

    var imgContent = document.getElementById("imgManip");
    var content = document.getElementById("upload");
    var newBox = document.getElementById("newBox");
    var file;
    var next0 = document.getElementById("next0");

    //cluster of variables to store positional information
    var x = 0;//Width of image
    var y = 0;//Height of image

    var x1 = 0;
    var y1 = 0;
    var x2 = 0;
    var y2 = 0;

    next0.onclick = function(){
        console.log("1");
        file = document.getElementById("file").files[0];

        var img = new Image();
        
        img.src = URL.createObjectURL(file);
        
        img.onload = function(){
            //Things that happen when the image has loaded.
            x = img.width;
            y = img.height;
            console.log("First: " + x + " : " + y);
            ctx.drawImage(img, 0, 0);
        }
    }   
    //Variables for tracking and controlling the creation of imagemaps
    var startDraw = false; //tracks if the "create new box" button has been pressed
    var stage = 0;//keeps track of where in the image map process the user is inn

    function draw(){
        //badly named function for starting the drawing and generator process
        startDraw = true;
    }

    canvas.onclick = function(evt){
        if(startDraw){
            switch (stage) {
                case 0://first stage
                    
                    x1 = evt.offsetX;
                    y1 = evt.offsetY;

                    //place second point
                    ctx.beginPath();
                    ctx.arc(x1, y1, 2, 0, 2 * Path.PI);
                    ctx.stroke();
                    
                    stage = 1;
                    break;
                case 1: //Second stage
                    
                    x2 = evt.offsetX;
                    y2 = evt.offsetY;
                    
                    //place second point
                    ctx.beginPath();
                    ctx.arc(x2, y2, 2, 0, 2 * Path.PI);
                    ctx.stroke();

                    //Create rectangle
                    ctx.rect(x1, y1, x2 - x1, y2 - y1);
                    ctx.stroke();

                    //execute code to generate imagemap

                    //Resett the tracking vars
                    stage = 0;
                    startDraw = false;
                    break;
                default:
                    break;
            }
        }
    }

</script>
</html>